% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hwe_exact_power.R
\name{hwe_exact_power}
\alias{hwe_exact_power}
\title{Calculate the power of an exact test for Hardy-Weinberg Equilibrium}
\usage{
hwe_exact_power(
  N,
  K,
  theta = NULL,
  f = NULL,
  sig.level = 0.05,
  alternative = "less",
  use_mid_p = FALSE
)
}
\arguments{
\item{N}{Integer, total number of diploid individuals in the population.}

\item{K}{Integer, total number of copies of the minor allele in the population (equivalent to minor allele count)}

\item{theta}{Numeric, optional, deviation parameter reflecting inbreeding coefficient; if not provided, `f` must be specified.}

\item{f}{Numeric, optional, inbreeding coefficient; if not provided, `theta` must be specified. Used to calculate `theta` if `theta` is not directly provided.}

\item{sig.level}{Numeric, significance level for identifying the rejection region under the null hypothesis; defaults to 0.05.}

\item{alternative}{Character, specifies the direction of the alternative hypothesis; currently only "less" and "greater" is implemented.}

\item{use_mid_p}{Logical, indicates whether to use the mid-p correction for the p-value calculation; defaults to FALSE. The mid-p correction is applied only to HWE p-values.}
}
\value{
Numeric, the power of the Hardy-Weinberg Equilibrium exact test.
}
\description{
Computes the statistical power of the exact test for Hardy-Weinberg Equilibrium
given a specific number of individuals, the number of minor alleles, and a theta parameter.
The power is defined as the probability that the test correctly rejects the null hypothesis
(HWE) when the alternative hypothesis is true. For a given Î¸, the power is calculated by summing 
the probabilities of all genotype counts that lead to the rejection of the null hypothesis.
While the rejection region is determined under the null hypothesis, the power calculation
is performed under the alternative hypothesis conditions.
}
\details{
The power calculation involves:
1. Calculating log probabilities of genotype configurations under both the null hypothesis (theta = 4)
   and the specified alternative hypothesis (current theta).
2. Determining the rejection region based on probabilities under the null hypothesis.
3. Summing probabilities under the alternative hypothesis for configurations within the rejection region.

This methodology allows assessing how effectively the HWE test can detect deviations
from equilibrium for different theta values, representing various inbreeding coefficients
or other forms of non-random mating.
}
\examples{
# Calculate power with specified theta
power <- hwe_exact_power(N = 100, K = 14, theta = 2, sig.level = 0.05, alternative="greater")

# Calculate power with specified inbreeding coefficient f
power_f <- hwe_exact_power(N = 100, K = 14, f = 0.01, sig.level = 0.05)

}
